"use strict";hui.define("hui_birthday",["hui_dropdown"],function(){hui.Birthday=function(e,t){hui.Birthday.superClass.call(this,e,"pending"),"pending"!=t&&this.enterControl()},hui.Birthday.prototype={getTpl:function(){var e=["<div ui=\"type:'Dropdown',formName:'yy',placeholder:'- 年 -',value:'',optionEnd:1900,optionStart:(new Date()).getFullYear(),optionStep:-1,size:{width:90,scrollTop:700}\"></div>","<div ui=\"type:'Dropdown',formName:'mm',placeholder:'- 月 -',value:'',optionStart:1,optionEnd:12,optionStep:1,size:{width:86}\"></div>","<div ui=\"type:'Dropdown',formName:'dd',placeholder:'- 日 -',value:'',optionStart:1,optionEnd:31,optionStep:1,size:{width:86}\"></div>"].join("\n");return e},render:function(){hui.Birthday.superClass.prototype.render.call(this);var e=this,t=e.getMain();e.setInnerHTML(e.getTpl()),hui.Control.init(t)},initBehavior:function(){var e=this,t=e.getByFormName("yy"),a=e.getByFormName("mm");t.onchange=hui.fn(e.updateMonth,e),a.onchange=hui.fn(e.updateDay,e)},updateMonth:function(){var e=this,t=e.getByFormName("yy"),a=e.getByFormName("dd"),o=e.getByFormName("mm"),i=t.getValue(),n=e.maxDate&&"now"!==e.maxDate?hui.parseDate(e.maxDate):new Date;e.maxDate&&i>=n.getFullYear()&&(o.optionEnd=n.getMonth()+1,o.setOptions()),o.getValue()||o.setValue(1),a.getValue()||a.setValue(1),e.updateDay()},updateDay:function(){var e=this,t=e.getByFormName("dd"),a=e.getByFormName("mm"),o=e.getByFormName("yy"),i=o.getValue()||2e3,n=Number(a.getValue()),r=e.maxDate&&"now"!==e.maxDate?hui.parseDate(e.maxDate):new Date;n&&(t.optionEnd=2===n?i%4===0&&i%100!==0||i%400===0?29:28:4===n||6===n||9===n||11===n?30:31,e.maxDate&&o.getValue()>=r.getFullYear()&&a.getValue()>=r.getMonth()+1&&(t.optionEnd=r.getDate()),t.getValue()>t.optionEnd&&t.setValue(t.optionEnd),t.setOptions())},getValue:function(){var e=this,t=e.getByFormName("dd"),a=e.getByFormName("mm"),o=e.getByFormName("yy"),i=t.getValue(),n=a.getValue(),r=o.getValue();return r&&n&&i?r+"-"+n+"-"+i:""},setValue:function(e){var t=this,a=t.getByFormName("dd"),o=t.getByFormName("mm"),i=t.getByFormName("yy"),n=hui.util.parseDate(e);i.setValue(n.getFullYear()),o.setValue(n.getMonth()+1),a.setValue(n.getDate())}},hui.inherits(hui.Birthday,hui.Control)});