"use strict";hui.define("hui_dropdown",["hui_util","hui_control"],function(){hui.Dropdown=function(t,o){hui.Dropdown.superClass.call(this,t,"pending"),this.data_value=this.data_value||"value",this.data_text=this.data_text||"text",this.autoHideError=void 0===this.autoHideError?!1:this.autoHideError,this.autoValidate=void 0===this.autoValidate?!1:this.autoValidate,"pending"!=o&&this.enterControl()},hui.Dropdown.expandClassName="hui_dropdown_expand",hui.Dropdown.prototype={initModel:function(){var t=this;t.options&&"string"==typeof t.options&&(t.options=JSON.parse(t.options))},getTitle:function(){var t=this,o=t.getMain(),i=hui.cc(t.getClass("title_text"),o);if(!i){var e=t.getDocument().createElement("DIV");e.className=t.getClass("title"),e.innerHTML='<span class="'+t.getClass("title_text")+'">&nbsp;</span> <i class="'+t.getClass("arrow")+'"><s class="'+t.getClass("arrow_icon")+'">&nbsp;</s></i>',o.appendChild(e),o.insertBefore(e,o.childNodes[0]),i=hui.cc(t.getClass("title_text"),e)}return i},getOptionContainer:function(){var t=this,o=t.getMain(),i=hui.cc(t.getClass("options"),o);return i||(i=t.getDocument().createElement("DIV"),i.className=t.getClass("options"),t.getMain().appendChild(i)),i},render:function(){hui.Dropdown.superClass.prototype.render.call(this);var t=this;t.setSize(),t.placeholder&&!t.value&&hui.setInnerText(t.getTitle(),t.placeholder),t.renderOptions()},initBehavior:function(){var t=this,o=t.getMain(),i=t.getTitle().parentNode,e=t.getOptionContainer();i.onclick=hui.fn(t.onTitleClick,t),e.onclick=t.onOptionsClick,o.onselectstart=new Function("return false;"),t.getShowOptionsHandler(),void 0!==t.value&&t.setValue(t.value)},onTitleClick:function(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation();var o=this;o.showOptions()},getShowOptionsHandler:function(){return this.showOptions=this.showOptions||hui.fn(function(){var t=this,o=t.getMain();hui.hasClass(o,hui.Dropdown.expandClassName)?(t.hideAllOptions(),hui.off(document.body,"click",t.showOptions)):(t.hideAllOptions(),hui.addClass(o,hui.Dropdown.expandClassName),t.size&&t.size.scrollTop&&!t.size.doscrollTop&&(hui.cc("hui_dropdown_options",o).scrollTop=t.size.scrollTop,t.size.doscrollTop=!0),hui.off(document.body,"click",t.showOptions),hui.on(document.body,"click",t.hideAllOptions))},this),this.showOptions},hideAllOptions:function(){for(var t=hui.c("hui_dropdown"),o=0,i=t.length;i>o;o++)hui.removeClass(t[o],hui.Dropdown.expandClassName)},onOptionsClick:function(t){t=t||window.event;var o,i,e=t.target||t.srcElement,n=hui.Control.findByElem(e);n&&(o=hui.util.findParentByClassName(e,n.getClass("item")),!o||void 0===o.value&&void 0===o.getAttribute("value")||(i=void 0!==o.value?o.value:o.getAttribute("value"),n.setValue(i),n.showOptions()))},removeOption:function(t){if(void 0!==t){for(var o,i,e=this,n=e.data_value,r=e.getOptionContainer(),a=hui.c(e.getClass("item"),r),s=a.length-1;s>-1;s--)o=void 0===a[s].value?a[s].getAttribute("value"):a[s].value,o===t&&r.removeChild(a[s]);for(var s=0,p=e.options.length;p>s;s++)i=e.options[s],o="string"==typeof i?i:i[n],o===t&&e.options.splice(s,1)}},removeOptionAll:function(){var t=this;t.options=[],hui.setInnerHTML(t.getOptionContainer(),"")},addOption:function(t){if(void 0!==t){var o=this,i=o.data_value,e=o.data_text,n=o.getDocument().createElement("DIV");n.value="string"==typeof t?t:t[i],n.className=o.getClass("item"),n.setAttribute("value",n.value),hui.setInnerText(n,"string"==typeof t?t:t[e]),o.getOptionContainer().appendChild(n)}},renderOptions:function(){var t,o=this,i=Number(o.optionStart),e=Number(o.optionEnd),n=Number(o.optionStep),r=[];if(!o.options&&void 0!==o.optionStart&&void 0!==o.optionEnd){i=i!==i?0:i,e=e!==e?0:e,n=n!==n?1:n,t=i;for(var a=0,s=Math.abs(e-i);s>=a;a+=Math.abs(n))r.push({value:t,text:t}),t+=n;o.options=r}if(o.options)for(var a=0,s=o.options.length;s>a;a++)o.addOption(o.options[a])},setOptions:function(t){var o=this;o.removeOptionAll(),o.options=t,o.renderOptions()},setValue:function(t){for(var o,i=this,e=i.data_value,n=i.data_text,r=i.options,a=t&&"object"==typeof t?t[e]:t,s=t&&"object"==typeof t?t[n]:"",p=0,d=r.length;d>p;p++)if(o=r[p],"string"==typeof o&&o===a||o[e]===a||void 0===a&&o[n]===s){hui.setInnerText(i.getTitle(),"string"==typeof o?o:o[n]),a=o[e],a!==i.value&&(o=i.getMain().value,i.getMain().value=a,i.autoHideError&&i.hideError(),i.autoValidate&&i.validate(),i.onchange(a,o));break}},getValue:function(){var t,o=this,i=o.data_value,e=o.getMain().value;if(o.options)for(var n=0,r=o.options.length;r>n;n++)if(t=o.options[n],"string"==typeof t&&t===e||t[i]===e){e=t[i];break}return e},getText:function(){var t,o=this,i=o.data_text,e=o.data_value,n=o.getMain().value;if(o.options)for(var r=0,a=o.options.length;a>r;r++)if(t=o.options[r],"string"==typeof t&&t===n||t[e]===n){n=t[i];break}return n},onchange:function(){}},hui.inherits(hui.Dropdown,hui.Control),hui.util.importCssString(".hui_dropdown{position:relative;z-index:2;background-color:white;float:left;margin-right:9px;}.hui_dropdown .hui_dropdown_title{padding-left:12px;color:#333;height:37px;line-height:1.5em;border:1px solid #ddd;line-height:37px;cursor:pointer;}.hui_dropdown .hui_dropdown_title:hover{border:1px solid #D1D0D1;color:#666;}.hui_dropdown .hui_dropdown_options{display:none;border:1px #ddd solid;background-color:#fff;position:absolute;width:99%;z-index:900;max-height:196px;overflow:auto;}.hui_dropdown .hui_dropdown_item{padding-left:12px;color:#333;height:2em;line-height:2em;cursor:pointer;}.hui_dropdown .hui_dropdown_item:hover{background-color:#ececec;}.hui_dropdown_arrow{position: absolute;z-index: 1;right: 2px;top: 4px;padding: 10px 5px;width: 12px;height: 11px;}.hui_dropdown_arrow_icon{border-style: solid;border-color: #999 transparent transparent;border-width: 10px 6px 0px;width: 0px;overflow: hidden;font-size: 0;height: 0px;line-height: 0px;vertical-align: top;position: absolute;}.hui_dropdown_expand{display:block;z-index:3;}.hui_dropdown_expand .hui_dropdown_options{display:block;}.hui_dropdown_expand .hui_dropdown_arrow{padding: 8px 5px 12px;}.hui_dropdown_expand .hui_dropdown_arrow_icon{border-color: transparent transparent #999 transparent;border-width: 0px 6px 10px;}")});